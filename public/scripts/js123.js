/* Modernizr 2.0.6 (Custom Build) | MIT & BSD * Build: http://www.modernizr.com/download/#-touch-iepp-cssclasses-teststyles-prefixes-load */
;window.Modernizr=function(a,b,c){function z(a,b){return!!~(""+a).indexOf(b)}function y(a,b){return typeof a===b}function x(a,b){return w(n.join(a+";")+(b||""))}function w(a){k.cssText=a}var d="2.0.6",e={},f=!0,g=b.documentElement,h=b.head||b.getElementsByTagName("head")[0],i="modernizr",j=b.createElement(i),k=j.style,l,m=Object.prototype.toString,n=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),o={},p={},q={},r=[],s=function(a,c,d,e){var f,h,j,k=b.createElement("div");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:i+(d+1),k.appendChild(j);f=["&shy;","<style>",a,"</style>"].join(""),k.id=i,k.innerHTML+=f,g.appendChild(k),h=c(k,a),k.parentNode.removeChild(k);return!!h},t,u={}.hasOwnProperty,v;!y(u,c)&&!y(u.call,c)?v=function(a,b){return u.call(a,b)}:v=function(a,b){return b in a&&y(a.constructor.prototype[b],c)};var A=function(c,d){var f=c.join(""),g=d.length;s(f,function(c,d){var f=b.styleSheets[b.styleSheets.length-1],h=f.cssRules&&f.cssRules[0]?f.cssRules[0].cssText:f.cssText||"",i=c.childNodes,j={};while(g--)j[i[g].id]=i[g];e.touch="ontouchstart"in a||j.touch.offsetTop===9},g,d)}([,["@media (",n.join("touch-enabled),("),i,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);o.touch=function(){return e.touch};for(var B in o)v(o,B)&&(t=B.toLowerCase(),e[t]=o[B](),r.push((e[t]?"":"no-")+t));w(""),j=l=null,a.attachEvent&&function(){var a=b.createElement("div");a.innerHTML="<elem></elem>";return a.childNodes.length!==1}()&&function(a,b){function s(a){var b=-1;while(++b<g)a.createElement(f[b])}a.iepp=a.iepp||{};var d=a.iepp,e=d.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",f=e.split("|"),g=f.length,h=new RegExp("(^|\\s)("+e+")","gi"),i=new RegExp("<(/*)("+e+")","gi"),j=/^\s*[\{\}]\s*$/,k=new RegExp("(^|[^\\n]*?\\s)("+e+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),l=b.createDocumentFragment(),m=b.documentElement,n=m.firstChild,o=b.createElement("body"),p=b.createElement("style"),q=/print|all/,r;d.getCSS=function(a,b){if(a+""===c)return"";var e=-1,f=a.length,g,h=[];while(++e<f){g=a[e];if(g.disabled)continue;b=g.media||b,q.test(b)&&h.push(d.getCSS(g.imports,b),g.cssText),b="all"}return h.join("")},d.parseCSS=function(a){var b=[],c;while((c=k.exec(a))!=null)b.push(((j.exec(c[1])?"\n":c[1])+c[2]+c[3]).replace(h,"$1.iepp_$2")+c[4]);return b.join("\n")},d.writeHTML=function(){var a=-1;r=r||b.body;while(++a<g){var c=b.getElementsByTagName(f[a]),d=c.length,e=-1;while(++e<d)c[e].className.indexOf("iepp_")<0&&(c[e].className+=" iepp_"+f[a])}l.appendChild(r),m.appendChild(o),o.className=r.className,o.id=r.id,o.innerHTML=r.innerHTML.replace(i,"<$1font")},d._beforePrint=function(){p.styleSheet.cssText=d.parseCSS(d.getCSS(b.styleSheets,"all")),d.writeHTML()},d.restoreHTML=function(){o.innerHTML="",m.removeChild(o),m.appendChild(r)},d._afterPrint=function(){d.restoreHTML(),p.styleSheet.cssText=""},s(b),s(l);d.disablePP||(n.insertBefore(p,n.firstChild),p.media="print",p.className="iepp-printshim",a.attachEvent("onbeforeprint",d._beforePrint),a.attachEvent("onafterprint",d._afterPrint))}(a,b),e._version=d,e._prefixes=n,e.testStyles=s,g.className=g.className.replace(/\bno-js\b/,"")+(f?" js "+r.join(" "):"");return e}(this,this.document),function(a,b,c){function k(a){return!a||a=="loaded"||a=="complete"}function j(){var a=1,b=-1;while(p.length- ++b)if(p[b].s&&!(a=p[b].r))break;a&&g()}function i(a){var c=b.createElement("script"),d;c.src=a.s,c.onreadystatechange=c.onload=function(){!d&&k(c.readyState)&&(d=1,j(),c.onload=c.onreadystatechange=null)},m(function(){d||(d=1,j())},H.errorTimeout),a.e?c.onload():n.parentNode.insertBefore(c,n)}function h(a){var c=b.createElement("link"),d;c.href=a.s,c.rel="stylesheet",c.type="text/css";if(!a.e&&(w||r)){var e=function(a){m(function(){if(!d)try{a.sheet.cssRules.length?(d=1,j()):e(a)}catch(b){b.code==1e3||b.message=="security"||b.message=="denied"?(d=1,m(function(){j()},0)):e(a)}},0)};e(c)}else c.onload=function(){d||(d=1,m(function(){j()},0))},a.e&&c.onload();m(function(){d||(d=1,j())},H.errorTimeout),!a.e&&n.parentNode.insertBefore(c,n)}function g(){var a=p.shift();q=1,a?a.t?m(function(){a.t=="c"?h(a):i(a)},0):(a(),j()):q=0}function f(a,c,d,e,f,h){function i(){!o&&k(l.readyState)&&(r.r=o=1,!q&&j(),l.onload=l.onreadystatechange=null,m(function(){u.removeChild(l)},0))}var l=b.createElement(a),o=0,r={t:d,s:c,e:h};l.src=l.data=c,!s&&(l.style.display="none"),l.width=l.height="0",a!="object"&&(l.type=d),l.onload=l.onreadystatechange=i,a=="img"?l.onerror=i:a=="script"&&(l.onerror=function(){r.e=r.r=1,g()}),p.splice(e,0,r),u.insertBefore(l,s?null:n),m(function(){o||(u.removeChild(l),r.r=r.e=o=1,j())},H.errorTimeout)}function e(a,b,c){var d=b=="c"?z:y;q=0,b=b||"j",C(a)?f(d,a,b,this.i++,l,c):(p.splice(this.i++,0,a),p.length==1&&g());return this}function d(){var a=H;a.loader={load:e,i:0};return a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=r&&!s,u=s?l:n.parentNode,v=a.opera&&o.call(a.opera)=="[object Opera]",w="webkitAppearance"in l.style,x=w&&"async"in b.createElement("script"),y=r?"object":v||x?"img":"script",z=w?"img":y,A=Array.isArray||function(a){return o.call(a)=="[object Array]"},B=function(a){return Object(a)===a},C=function(a){return typeof a=="string"},D=function(a){return o.call(a)=="[object Function]"},E=[],F={},G,H;H=function(a){function f(a){var b=a.split("!"),c=E.length,d=b.pop(),e=b.length,f={url:d,origUrl:d,prefixes:b},g,h;for(h=0;h<e;h++)g=F[b[h]],g&&(f=g(f));for(h=0;h<c;h++)f=E[h](f);return f}function e(a,b,e,g,h){var i=f(a),j=i.autoCallback;if(!i.bypass){b&&(b=D(b)?b:b[a]||b[g]||b[a.split("/").pop().split("?")[0]]);if(i.instead)return i.instead(a,b,e,g,h);e.load(i.url,i.forceCSS||!i.forceJS&&/css$/.test(i.url)?"c":c,i.noexec),(D(b)||D(j))&&e.load(function(){d(),b&&b(i.origUrl,h,g),j&&j(i.origUrl,h,g)})}}function b(a,b){function c(a){if(C(a))e(a,h,b,0,d);else if(B(a))for(i in a)a.hasOwnProperty(i)&&e(a[i],h,b,i,d)}var d=!!a.test,f=d?a.yep:a.nope,g=a.load||a.both,h=a.callback,i;c(f),c(g),a.complete&&b.load(a.complete)}var g,h,i=this.yepnope.loader;if(C(a))e(a,0,i,0);else if(A(a))for(g=0;g<a.length;g++)h=a[g],C(h)?e(h,0,i,0):A(h)?H(h):B(h)&&b(h,i);else B(a)&&b(a,i)},H.addPrefix=function(a,b){F[a]=b},H.addFilter=function(a){E.push(a)},H.errorTimeout=1e4,b.readyState==null&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",G=function(){b.removeEventListener("DOMContentLoaded",G,0),b.readyState="complete"},0)),a.yepnope=d()}(this,this.document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};
function Sketcher(a,b,c){this.renderFunction=c==null||c==undefined?this.updateCanvasByLine:this.updateCanvasByBrush;this.brush=c;this.touchSupported=Modernizr.touch;this.canvasID=a;this.canvas=$("#"+a);this.context=this.canvas.get(0).getContext("2d");this.context.strokeStyle="#"+b;this.context.lineWidth=this.brushSize();this.lastMousePoint={x:0,y:0};if(this.touchSupported){this.mouseDownEvent="touchstart";this.mouseMoveEvent="touchmove";this.mouseUpEvent="touchend"}else{this.mouseDownEvent="mousedown";this.mouseMoveEvent="mousemove";this.mouseUpEvent="mouseup"}this.canvas.bind(this.mouseDownEvent,this.onCanvasMouseDown())}Sketcher.prototype.shapeColor=function(){var a=document.getElementById("shapeColor");return a.value};Sketcher.prototype.previewHandler=function(){this.updateGradient();var a=document.getElementById("shape");var b=a.selectedIndex;var c=a[b].value;if(c=="squares"){for(var d=0;d<20;d++){this.drawSquare()}}else if(c=="circles"){for(var e=0;e<20;e++){this.drawCircle()}}else if(c=="dots"){for(var e=0;e<100;e++){this.drawDots()}}this.updateFont()};Sketcher.prototype.drawDots=function(){var a=this.canvas[0];var b=1.5;var c=Math.floor(Math.random()*a.width);var d=Math.floor(Math.random()*a.height);this.context.beginPath();this.context.arc(c,d,b,0,this.degreeToRadians(360),true);this.context.fillStyle="#"+this.shapeColor();this.context.fill()};Sketcher.prototype.drawSquare=function(){var a=this.canvas[0];var b=Math.floor(Math.random()*40);var c=Math.floor(Math.random()*a.width);var d=Math.floor(Math.random()*a.height);this.context.fillStyle="#"+this.shapeColor();this.context.fillRect(c,d,b,b)};Sketcher.prototype.drawCircle=function(){var a=this.canvas[0];var b=Math.floor(Math.random()*40);var c=Math.floor(Math.random()*a.width);var d=Math.floor(Math.random()*a.height);this.context.beginPath();this.context.arc(c,d,b,0,this.degreeToRadians(360),true);this.context.fillStyle="#"+this.shapeColor();this.context.fill()};Sketcher.prototype.degreeToRadians=function(a){return a*Math.PI/180};Sketcher.prototype.brushColor=function(){var a=document.getElementById("fbCover");var b=a.getContext("2d");var c=document.getElementById("colorBrush").value;b.strokeStyle="#"+c;this.context.lineWidth=this.brushSize()};Sketcher.prototype.eraseIt=function(){var a=$(":checkbox:checked");if(a.length==1){$("#fbCover").addClass("eraser");var b=document.getElementById("color");var c=b.value;this.context.strokeStyle="#"+c;this.context.lineWidth=10}else{$("#fbCover").removeClass("eraser");var d=document.getElementById("colorBrush").value;this.context.strokeStyle="#"+d;this.context.lineWidth=this.brushSize()}var e=this.canvas[0];e.onselectstart=function(){return false};e.onmousedown=function(){return false}};Sketcher.prototype.brushSize=function(){var a=document.getElementById("brushSize");var b=a.selectedIndex;var c=a[b].value;if(c=="small-x")c=1;else if(c=="small-xx")c=2;else if(c=="medium-x")c=4;else if(c=="medium-xx")c=6;else if(c=="big-x")c=8;else if(c=="big-xx")c=22;return c};Sketcher.prototype.onCanvasMouseDown=function(){var a=this;return function(b){a.mouseMoveHandler=a.onCanvasMouseMove();a.mouseUpHandler=a.onCanvasMouseUp();$(document).bind(a.mouseMoveEvent,a.mouseMoveHandler);$(document).bind(a.mouseUpEvent,a.mouseUpHandler);a.updateMousePosition(b);a.renderFunction(b)}};Sketcher.prototype.onCanvasMouseMove=function(){var a=this;return function(b){a.renderFunction(b);b.preventDefault();return false}};Sketcher.prototype.onCanvasMouseUp=function(a){var b=this;return function(a){$(document).unbind(b.mouseMoveEvent,b.mouseMoveHandler);$(document).unbind(b.mouseUpEvent,b.mouseUpHandler);b.mouseMoveHandler=null;b.mouseUpHandler=null}};Sketcher.prototype.updateMousePosition=function(a){var b;if(this.touchSupported){b=a.originalEvent.touches[0]}else{b=a}var c=this.canvas.offset();this.lastMousePoint.x=b.pageX-c.left;this.lastMousePoint.y=b.pageY-c.top};Sketcher.prototype.updateCanvasByLine=function(a){this.context.beginPath();this.context.moveTo(this.lastMousePoint.x,this.lastMousePoint.y);this.updateMousePosition(a);this.context.lineTo(this.lastMousePoint.x,this.lastMousePoint.y);this.context.stroke()};Sketcher.prototype.updateCanvasByBrush=function(a){var b=this.brush.width/2;var c=this.brush.height/2;var d={x:this.lastMousePoint.x,y:this.lastMousePoint.y};this.updateMousePosition(a);var e={x:this.lastMousePoint.x,y:this.lastMousePoint.y};var f=parseInt(Trig.distanceBetween2Points(d,e));var g=Trig.angleBetween2Points(d,e);var h,i;for(var j=0;j<=f||j==0;j++){h=d.x+Math.sin(g)*j-b;i=d.y+Math.cos(g)*j-c;this.context.drawImage(this.brush,h,i)}};Sketcher.prototype.toString=function(){var a=this.canvas.get(0).toDataURL("image/png");var b=a.indexOf(",")+1;a=a.substring(b);return a};Sketcher.prototype.save=function(){var a=document.getElementById("fbCover");window.location=this.toDataURL()};Sketcher.prototype.toDataURL=function(){var a=this.canvas.get(0).toDataURL("image/png");return a};Sketcher.prototype.clear=function(){var a=this.canvas[0];this.context.clearRect(0,0,a.width,a.height);this.updateGradient();this.updateFont()};Sketcher.prototype.updateGradient=function(){var a=this.canvas[0];var b=document.getElementById("color");var c=b.value;this.context.fillStyle="#"+c;this.context.fillRect(0,0,a.width,a.height);this.updateFont()};Sketcher.prototype.updateFont=function(){var a=this.canvas[0];var b=document.getElementById("colorFont");var c=b.value;this.context.fillStyle="#"+c;this.context.font="bold 1em verdana";this.context.textAlign="right";this.context.fillText("wethementors.com",a.width-10,a.height-10)}
/** * jscolor, JavaScript Color Picker * * @version 1.3.13 * @license GNU Lesser General Public License, http://www.gnu.org/copyleft/lesser.html * @author  Jan Odvarko, http://odvarko.cz * @created 2008-06-15 * @updated 2012-01-19 * @link    http://jscolor.com */
var jscolor={dir:"",bindClass:"color",binding:true,preloading:true,install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){if(jscolor.binding){jscolor.bind()}if(jscolor.preloading){jscolor.preload()}},getDir:function(){if(!jscolor.dir){var a=jscolor.detectDir();jscolor.dir=a!==false?a:"scripts/"}return jscolor.dir},detectDir:function(){var a=location.href;var b=document.getElementsByTagName("base");for(var c=0;c<b.length;c+=1){if(b[c].href){a=b[c].href}}var b=document.getElementsByTagName("script");for(var c=0;c<b.length;c+=1){if(b[c].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(b[c].src)){var d=new jscolor.URI(b[c].src);var e=d.toAbsolute(a);e.path=e.path.replace(/[^\/]+$/,"");e.query=null;e.fragment=null;return e.toString()}}return false},bind:function(){var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i");var e=document.getElementsByTagName("input");for(var i=0;i<e.length;i+=1){var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3]){try{eval("prop="+m[3])}catch(eInvalidProp){}}e[i].color=new jscolor.color(e[i],prop)}}},preload:function(){for(var a in jscolor.imgRequire){if(jscolor.imgRequire.hasOwnProperty(a)){jscolor.loadImage(a)}}},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(a){jscolor.imgRequire[a]=true},loadImage:function(a){if(!jscolor.imgLoaded[a]){jscolor.imgLoaded[a]=new Image;jscolor.imgLoaded[a].src=jscolor.getDir()+a}},fetchElement:function(a){return typeof a==="string"?document.getElementById(a):a},addEvent:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}},fireEvent:function(a,b){if(!a){return}if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(b,true,true);a.dispatchEvent(c)}else if(document.createEventObject){var c=document.createEventObject();a.fireEvent("on"+b,c)}else if(a["on"+b]){a["on"+b]()}},getElementPos:function(a){var b=a,c=a;var d=0,e=0;if(b.offsetParent){do{d+=b.offsetLeft;e+=b.offsetTop}while(b=b.offsetParent)}while((c=c.parentNode)&&c.nodeName.toUpperCase()!=="BODY"){d-=c.scrollLeft;e-=c.scrollTop}return[d,e]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getRelMousePos:function(a){var b=0,c=0;if(!a){a=window.event}if(typeof a.offsetX==="number"){b=a.offsetX;c=a.offsetY}else if(typeof a.layerX==="number"){b=a.layerX;c=a.layerY}return{x:b,y:c}},getViewPos:function(){if(typeof window.pageYOffset==="number"){return[window.pageXOffset,window.pageYOffset]}else if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){return[document.body.scrollLeft,document.body.scrollTop]}else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]}else{return[0,0]}},getViewSize:function(){if(typeof window.innerWidth==="number"){return[window.innerWidth,window.innerHeight]}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){return[document.body.clientWidth,document.body.clientHeight]}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){return[document.documentElement.clientWidth,document.documentElement.clientHeight]}else{return[0,0]}},URI:function(a){function b(a){var b="";while(a){if(a.substr(0,3)==="../"||a.substr(0,2)==="./"){a=a.replace(/^\.+/,"").substr(1)}else if(a.substr(0,3)==="/./"||a==="/."){a="/"+a.substr(3)}else if(a.substr(0,4)==="/../"||a==="/.."){a="/"+a.substr(4);b=b.replace(/\/?[^\/]*$/,"")}else if(a==="."||a===".."){a=""}else{var c=a.match(/^\/?[^\/]*/)[0];a=a.substr(c.length);b=b+c}}return b}this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(a){var b=a.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=b[3]?b[2]:null;this.authority=b[5]?b[6]:null;this.path=b[7];this.query=b[9]?b[10]:null;this.fragment=b[12]?b[13]:null;return this};this.toString=function(){var a="";if(this.scheme!==null){a=a+this.scheme+":"}if(this.authority!==null){a=a+"//"+this.authority}if(this.path!==null){a=a+this.path}if(this.query!==null){a=a+"?"+this.query}if(this.fragment!==null){a=a+"#"+this.fragment}return a};this.toAbsolute=function(a){var a=new jscolor.URI(a);var c=this;var d=new jscolor.URI;if(a.scheme===null){return false}if(c.scheme!==null&&c.scheme.toLowerCase()===a.scheme.toLowerCase()){c.scheme=null}if(c.scheme!==null){d.scheme=c.scheme;d.authority=c.authority;d.path=b(c.path);d.query=c.query}else{if(c.authority!==null){d.authority=c.authority;d.path=b(c.path);d.query=c.query}else{if(c.path===""){d.path=a.path;if(c.query!==null){d.query=c.query}else{d.query=a.query}}else{if(c.path.substr(0,1)==="/"){d.path=b(c.path)}else{if(a.authority!==null&&a.path===""){d.path="/"+c.path}else{d.path=a.path.replace(/[^\/]+$/,"")+c.path}d.path=b(d.path)}d.query=c.query}d.authority=a.authority}d.scheme=a.scheme}d.fragment=c.fragment;return d};if(a){this.parse(a)}},color:function(target,prop){function RGB_HSV(a,b,c){var d=Math.min(Math.min(a,b),c);var e=Math.max(Math.max(a,b),c);var f=e-d;if(f===0){return[null,0,e]}var g=a===d?3+(c-b)/f:b===d?5+(a-c)/f:1+(b-a)/f;return[g===6?0:g,f/e,e]}function HSV_RGB(a,b,c){if(a===null){return[c,c,c]}var d=Math.floor(a);var e=d%2?a-d:1-(a-d);var f=c*(1-b);var g=c*(1-b*e);switch(d){case 6:case 0:return[c,g,f];case 1:return[g,c,f];case 2:return[f,c,g];case 3:return[f,g,c];case 4:return[g,f,c];case 5:return[c,f,g]}}function removePicker(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function drawPicker(a,b){function i(){var a=THIS.pickerInsetColor.split(/\s+/);var b=a.length<2?a[0]:a[1]+" "+a[0]+" "+a[0]+" "+a[1];f.btn.style.borderColor=b}if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(THIS.pickerCloseText)};for(var c=0,d=4;c<jscolor.images.sld[1];c+=d){var e=document.createElement("div");e.style.height=d+"px";e.style.fontSize="1px";e.style.lineHeight="0";jscolor.picker.sld.appendChild(e)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.btnS.appendChild(jscolor.picker.btnT);jscolor.picker.btn.appendChild(jscolor.picker.btnS);jscolor.picker.box.appendChild(jscolor.picker.btn);jscolor.picker.boxB.appendChild(jscolor.picker.box)}var f=jscolor.picker;f.box.onmouseup=f.box.onmouseout=function(){target.focus()};f.box.onmousedown=function(){abortBlur=true};f.box.onmousemove=function(a){if(holdPad||holdSld){holdPad&&setPad(a);holdSld&&setSld(a);if(document.selection){document.selection.empty()}else if(window.getSelection){window.getSelection().removeAllRanges()}dispatchImmediateChange()}};f.padM.onmouseup=f.padM.onmouseout=function(){if(holdPad){holdPad=false;jscolor.fireEvent(valueElement,"change")}};f.padM.onmousedown=function(a){switch(modeID){case 0:if(THIS.hsv[2]===0){THIS.fromHSV(null,null,1)}break;case 1:if(THIS.hsv[1]===0){THIS.fromHSV(null,1,null)}break}holdPad=true;setPad(a);dispatchImmediateChange()};f.sldM.onmouseup=f.sldM.onmouseout=function(){if(holdSld){holdSld=false;jscolor.fireEvent(valueElement,"change")}};f.sldM.onmousedown=function(a){holdSld=true;setSld(a);dispatchImmediateChange()};var g=getPickerDims(THIS);f.box.style.width=g[0]+"px";f.box.style.height=g[1]+"px";f.boxB.style.position="absolute";f.boxB.style.clear="both";f.boxB.style.left=a+"px";f.boxB.style.top=b+"px";f.boxB.style.zIndex=THIS.pickerZIndex;f.boxB.style.border=THIS.pickerBorder+"px solid";f.boxB.style.borderColor=THIS.pickerBorderColor;f.boxB.style.background=THIS.pickerFaceColor;f.pad.style.width=jscolor.images.pad[0]+"px";f.pad.style.height=jscolor.images.pad[1]+"px";f.padB.style.position="absolute";f.padB.style.left=THIS.pickerFace+"px";f.padB.style.top=THIS.pickerFace+"px";f.padB.style.border=THIS.pickerInset+"px solid";f.padB.style.borderColor=THIS.pickerInsetColor;f.padM.style.position="absolute";f.padM.style.left="0";f.padM.style.top="0";f.padM.style.width=THIS.pickerFace+2*THIS.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";f.padM.style.height=f.box.style.height;f.padM.style.cursor="crosshair";f.sld.style.overflow="hidden";f.sld.style.width=jscolor.images.sld[0]+"px";f.sld.style.height=jscolor.images.sld[1]+"px";f.sldB.style.display=THIS.slider?"block":"none";f.sldB.style.position="absolute";f.sldB.style.right=THIS.pickerFace+"px";f.sldB.style.top=THIS.pickerFace+"px";f.sldB.style.border=THIS.pickerInset+"px solid";f.sldB.style.borderColor=THIS.pickerInsetColor;f.sldM.style.display=THIS.slider?"block":"none";f.sldM.style.position="absolute";f.sldM.style.right="0";f.sldM.style.top="0";f.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+THIS.pickerFace+2*THIS.pickerInset+"px";f.sldM.style.height=f.box.style.height;try{f.sldM.style.cursor="pointer"}catch(h){f.sldM.style.cursor="hand"}f.btn.style.display=THIS.pickerClosable?"block":"none";f.btn.style.position="absolute";f.btn.style.left=THIS.pickerFace+"px";f.btn.style.bottom=THIS.pickerFace+"px";f.btn.style.padding="0 15px";f.btn.style.height="18px";f.btn.style.border=THIS.pickerInset+"px solid";i();f.btn.style.color=THIS.pickerButtonColor;f.btn.style.font="12px sans-serif";f.btn.style.textAlign="center";try{f.btn.style.cursor="pointer"}catch(h){f.btn.style.cursor="hand"}f.btn.onmousedown=function(){THIS.hidePicker()};f.btnS.style.lineHeight=f.btn.style.height;switch(modeID){case 0:var j="hs.png";break;case 1:var j="hv.png";break}f.padM.style.backgroundImage="url('"+jscolor.getDir()+"cross.gif')";f.padM.style.backgroundRepeat="no-repeat";f.sldM.style.backgroundImage="url('"+jscolor.getDir()+"arrow.gif')";f.sldM.style.backgroundRepeat="no-repeat";f.pad.style.backgroundImage="url('"+jscolor.getDir()+j+"')";f.pad.style.backgroundRepeat="no-repeat";f.pad.style.backgroundPosition="0 0";redrawPad();redrawSld();jscolor.picker.owner=THIS;document.getElementsByTagName("body")[0].appendChild(f.boxB)}function getPickerDims(a){var b=[2*a.pickerInset+2*a.pickerFace+jscolor.images.pad[0]+(a.slider?2*a.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),a.pickerClosable?4*a.pickerInset+3*a.pickerFace+jscolor.images.pad[1]+a.pickerButtonHeight:2*a.pickerInset+2*a.pickerFace+jscolor.images.pad[1]];return b}function redrawPad(){switch(modeID){case 0:var a=1;break;case 1:var a=2;break}var b=Math.round(THIS.hsv[0]/6*(jscolor.images.pad[0]-1));var c=Math.round((1-THIS.hsv[a])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=THIS.pickerFace+THIS.pickerInset+b-Math.floor(jscolor.images.cross[0]/2)+"px "+(THIS.pickerFace+THIS.pickerInset+c-Math.floor(jscolor.images.cross[1]/2))+"px";var d=jscolor.picker.sld.childNodes;switch(modeID){case 0:var e=HSV_RGB(THIS.hsv[0],THIS.hsv[1],1);for(var f=0;f<d.length;f+=1){d[f].style.backgroundColor="rgb("+e[0]*(1-f/d.length)*100+"%,"+e[1]*(1-f/d.length)*100+"%,"+e[2]*(1-f/d.length)*100+"%)"}break;case 1:var e,g,h=[THIS.hsv[2],0,0];var f=Math.floor(THIS.hsv[0]);var i=f%2?THIS.hsv[0]-f:1-(THIS.hsv[0]-f);switch(f){case 6:case 0:e=[0,1,2];break;case 1:e=[1,0,2];break;case 2:e=[2,0,1];break;case 3:e=[2,1,0];break;case 4:e=[1,2,0];break;case 5:e=[0,2,1];break}for(var f=0;f<d.length;f+=1){g=1-1/(d.length-1)*f;h[1]=h[0]*(1-g*i);h[2]=h[0]*(1-g);d[f].style.backgroundColor="rgb("+h[e[0]]*100+"%,"+h[e[1]]*100+"%,"+h[e[2]]*100+"%)"}break}}function redrawSld(){switch(modeID){case 0:var a=2;break;case 1:var a=1;break}var b=Math.round((1-THIS.hsv[a])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(THIS.pickerFace+THIS.pickerInset+b-Math.floor(jscolor.images.arrow[1]/2))+"px"}function isPickerOwner(){return jscolor.picker&&jscolor.picker.owner===THIS}function blurTarget(){if(valueElement===target){THIS.importColor()}if(THIS.pickerOnfocus){THIS.hidePicker()}}function blurValue(){if(valueElement!==target){THIS.importColor()}}function setPad(a){var b=jscolor.getRelMousePos(a);var c=b.x-THIS.pickerFace-THIS.pickerInset;var d=b.y-THIS.pickerFace-THIS.pickerInset;switch(modeID){case 0:THIS.fromHSV(c*(6/(jscolor.images.pad[0]-1)),1-d/(jscolor.images.pad[1]-1),null,leaveSld);break;case 1:THIS.fromHSV(c*(6/(jscolor.images.pad[0]-1)),null,1-d/(jscolor.images.pad[1]-1),leaveSld);break}}function setSld(a){var b=jscolor.getRelMousePos(a);var c=b.y-THIS.pickerFace-THIS.pickerInset;switch(modeID){case 0:THIS.fromHSV(null,null,1-c/(jscolor.images.sld[1]-1),leavePad);break;case 1:THIS.fromHSV(null,1-c/(jscolor.images.sld[1]-1),null,leavePad);break}}function dispatchImmediateChange(){if(THIS.onImmediateChange){if(typeof THIS.onImmediateChange==="string"){eval(THIS.onImmediateChange)}else{THIS.onImmediateChange(THIS)}}}this.required=true;this.adjust=true;this.hash=false;this.caps=true;this.slider=true;this.valueElement=target;this.styleElement=target;this.onImmediateChange=null;this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=true;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerSmartPosition=true;this.pickerButtonHeight=20;this.pickerClosable=false;this.pickerCloseText="Close";this.pickerButtonColor="ButtonText";this.pickerFace=10;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=1e4;for(var p in prop){if(prop.hasOwnProperty(p)){this[p]=prop[p]}}this.hidePicker=function(){if(isPickerOwner()){removePicker()}};this.showPicker=function(){if(!isPickerOwner()){var a=jscolor.getElementPos(target);var b=jscolor.getElementSize(target);var c=jscolor.getViewPos();var d=jscolor.getViewSize();var e=getPickerDims(this);var f,g,h;switch(this.pickerPosition.toLowerCase()){case"left":f=1;g=0;h=-1;break;case"right":f=1;g=0;h=1;break;case"top":f=0;g=1;h=-1;break;default:f=0;g=1;h=1;break}var i=(b[g]+e[g])/2;if(!this.pickerSmartPosition){var j=[a[f],a[g]+b[g]-i+i*h]}else{var j=[-c[f]+a[f]+e[f]>d[f]?-c[f]+a[f]+b[f]/2>d[f]/2&&a[f]+b[f]-e[f]>=0?a[f]+b[f]-e[f]:a[f]:a[f],-c[g]+a[g]+b[g]+e[g]-i+i*h>d[g]?-c[g]+a[g]+b[g]/2>d[g]/2&&a[g]+b[g]-i-i*h>=0?a[g]+b[g]-i-i*h:a[g]+b[g]-i+i*h:a[g]+b[g]-i+i*h>=0?a[g]+b[g]-i+i*h:a[g]+b[g]-i-i*h]}drawPicker(j[f],j[g])}};this.importColor=function(){if(!valueElement){this.exportColor()}else{if(!this.adjust){if(!this.fromString(valueElement.value,leaveValue)){styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage;styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor;styleElement.style.color=styleElement.jscStyle.color;this.exportColor(leaveValue|leaveStyle)}}else if(!this.required&&/^\s*$/.test(valueElement.value)){valueElement.value="";styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage;styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor;styleElement.style.color=styleElement.jscStyle.color;this.exportColor(leaveValue|leaveStyle)}else if(this.fromString(valueElement.value)){}else{this.exportColor()}}};this.exportColor=function(a){if(!(a&leaveValue)&&valueElement){var b=this.toString();if(this.caps){b=b.toUpperCase()}if(this.hash){b="#"+b}valueElement.value=b}if(!(a&leaveStyle)&&styleElement){styleElement.style.backgroundImage="none";styleElement.style.backgroundColor="#"+this.toString();styleElement.style.color=.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]<.5?"#FFF":"#000"}if(!(a&leavePad)&&isPickerOwner()){redrawPad()}if(!(a&leaveSld)&&isPickerOwner()){redrawSld()}};this.fromHSV=function(a,b,c,d){a<0&&(a=0)||a>6&&(a=6);b<0&&(b=0)||b>1&&(b=1);c<0&&(c=0)||c>1&&(c=1);this.rgb=HSV_RGB(a===null?this.hsv[0]:this.hsv[0]=a,b===null?this.hsv[1]:this.hsv[1]=b,c===null?this.hsv[2]:this.hsv[2]=c);this.exportColor(d)};this.fromRGB=function(a,b,c,d){a<0&&(a=0)||a>1&&(a=1);b<0&&(b=0)||b>1&&(b=1);c<0&&(c=0)||c>1&&(c=1);var e=RGB_HSV(a===null?this.rgb[0]:this.rgb[0]=a,b===null?this.rgb[1]:this.rgb[1]=b,c===null?this.rgb[2]:this.rgb[2]=c);if(e[0]!==null){this.hsv[0]=e[0]}if(e[2]!==0){this.hsv[1]=e[1]}this.hsv[2]=e[2];this.exportColor(d)};this.fromString=function(a,b){var c=a.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(!c){return false}else{if(c[1].length===6){this.fromRGB(parseInt(c[1].substr(0,2),16)/255,parseInt(c[1].substr(2,2),16)/255,parseInt(c[1].substr(4,2),16)/255,b)}else{this.fromRGB(parseInt(c[1].charAt(0)+c[1].charAt(0),16)/255,parseInt(c[1].charAt(1)+c[1].charAt(1),16)/255,parseInt(c[1].charAt(2)+c[1].charAt(2),16)/255,b)}return true}};this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};var THIS=this;var modeID=this.pickerMode.toLowerCase()==="hvs"?1:0;var abortBlur=false;var valueElement=jscolor.fetchElement(this.valueElement),styleElement=jscolor.fetchElement(this.styleElement);var holdPad=false,holdSld=false;var leaveValue=1<<0,leaveStyle=1<<1,leavePad=1<<2,leaveSld=1<<3;jscolor.addEvent(target,"focus",function(){if(THIS.pickerOnfocus){THIS.showPicker()}});jscolor.addEvent(target,"blur",function(){if(!abortBlur){window.setTimeout(function(){abortBlur||blurTarget();abortBlur=false},0)}else{abortBlur=false}});if(valueElement){var updateField=function(){THIS.fromString(valueElement.value,leaveValue);dispatchImmediateChange()};jscolor.addEvent(valueElement,"keyup",updateField);jscolor.addEvent(valueElement,"input",updateField);jscolor.addEvent(valueElement,"blur",blurValue);valueElement.setAttribute("autocomplete","off")}if(styleElement){styleElement.jscStyle={backgroundImage:styleElement.style.backgroundImage,backgroundColor:styleElement.style.backgroundColor,color:styleElement.style.color}}switch(modeID){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png");break}jscolor.requireImage("cross.gif");jscolor.requireImage("arrow.gif");this.importColor()}};jscolor.install()